# CI/CD Workflows Guide

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –Ω–∞–±–æ—Ä GitHub Actions workflow –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ CI/CD –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

## ‚öôÔ∏è Workflow Overview

### 1. `ci.yml`
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º push –∏ pull request.
- –ü–æ–¥–Ω–∏–º–∞–µ—Ç PostgreSQL + PHP 8.3.
- –í—ã–ø–æ–ª–Ω—è–µ—Ç `make ci` (lint + stan + test + coverage).

### 2. `qa.yml`
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ pull request.
- –í—ã–ø–æ–ª–Ω—è–µ—Ç –±—ã—Å—Ç—Ä—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞: `make qa` (lint + stan + test + cs-fixer dry-run).

### 3. `migrations.yml`
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ pull request.
- –ü–æ–¥–Ω–∏–º–∞–µ—Ç PostgreSQL.
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç Doctrine —Å—Ö–µ–º—É, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏ –ø—Ä–æ–≥–æ–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏.

### 4. `full-ci.yml`
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ push –∏ pull request.
- –í–∫–ª—é—á–∞–µ—Ç 3 job'–∞: `qa`, `migrations`, `tests`.
- –ü–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω (–∞–Ω–∞–ª–æ–≥ CI/CD).

### 5. `nightly.yml`
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (cron) –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 02:00 UTC.
- –í—ã–ø–æ–ª–Ω—è–µ—Ç `make ci` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞.

### 6. `release.yml`
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ –ø—É—à–µ git-—Ç–µ–≥–∞ (`v*.*.*`).
- –°—Ç–∞–≤–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–±–µ–∑ dev).
- –ü—Ä–æ–≥–æ–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏.
- –°–æ–∑–¥–∞—ë—Ç GitHub Release —Å release notes.

### 7. `deploy.yml`
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ –ø—É—à–µ –≤ –≤–µ—Ç–∫—É `main`.
- –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –ø–æ SSH (–∫–ª—é—á –∏–∑ `SSH_PRIVATE_KEY`).
- –ö–æ–ø–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã —á–µ—Ä–µ–∑ `rsync`.
- –í—ã–ø–æ–ª–Ω—è–µ—Ç `docker-compose up -d --build` –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

## üîë –¢—Ä–µ–±—É–µ–º—ã–µ Secrets

- `SSH_PRIVATE_KEY` ‚Äî –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è –¥–µ–ø–ª–æ—è.
- `DATABASE_URL` ‚Äî —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL.
- `APP_SECRET` ‚Äî —Å–µ–∫—Ä–µ—Ç Symfony.
- `JWT_PASSPHRASE` ‚Äî –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è.
- `DOCKER_HUB_USERNAME`, `DOCKER_HUB_ACCESS_TOKEN` ‚Äî –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Docker Hub.

## üì¶ Makefile Targets

Workflow –≤—ã–∑—ã–≤–∞—é—Ç –∫–æ–º–∞–Ω–¥—ã –∏–∑ Makefile:

- `make test` ‚Äî PHPUnit.
- `make test-parallel` ‚Äî Paratest.
- `make coverage` ‚Äî –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞.
- `make stan` ‚Äî PHPStan.
- `make fixtures` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∏–∫—Å—Ç—É—Ä.
- `make migrate` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π.
- `make cs-fix` ‚Äî –∞–≤—Ç–æ—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.
- `make lint` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ PHP.
- `make check` ‚Äî –ø–æ–ª–Ω—ã–π CI (lint + stan + test).
- `make qa` ‚Äî check + php-cs-fixer dry-run.
- `make ci` ‚Äî qa + coverage.

---
‚úÖ –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø—Ä–æ–µ–∫—Ç –∏–º–µ–µ—Ç –ø–æ–ª–Ω—ã–π CI/CD pipeline —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π QA, –º–∏–≥—Ä–∞—Ü–∏–π, —Ä–µ–ª–∏–∑–æ–≤ –∏ –¥–µ–ø–ª–æ—è.
