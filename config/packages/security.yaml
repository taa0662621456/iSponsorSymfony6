security:
    enable_authenticator_manager: true
    hide_user_not_found: true

    password_hashers:
        Symfony\Component\Security\Core\User\PasswordAuthenticatedUserInterface: 'auto'

    providers:
        postgres_users:
            entity:
                class: App\Entity\Vendor\VendorSecurity
                property: email

    role_hierarchy:
        ROLE_ADMIN: [ROLE_USER]
        ROLE_SUPER_ADMIN: [ROLE_ADMIN, ROLE_ALLOWED_TO_SWITCH]

    firewalls:
        # Отключаем security для дев-инструментов
        dev:
            pattern: ^/(_(profiler|wdt)|css|images|js)/
            security: false

        # Основной firewall
        main:
            lazy: true
            provider: postgres_users

            # если используешь JWT / API Token
            jwt:
                authenticator: lexik_jwt_authentication.jwt_token_authenticator

            # если используешь классический login_form_authenticator
            # custom_authenticator: App\Security\LoginFormAuthenticator

            logout:
                path: app_logout
                invalidate_session: true

    access_control:
        # Админка
        - { path: ^/admin, roles: ROLE_ADMIN }
        # API
        - { path: ^/api, roles: ROLE_USER }
        # всё остальное доступно анонимам (регистрация, login)
        - { path: ^/(login|register|reset-password), roles: PUBLIC_ACCESS }
